---
title: "CaSym: Cache Aware Symbolic Execution for Side Channel Detection and Mitigation"
subtitle: "S&P2019 | 用于侧信道的符号执行"
layout: post
author: "Veronica"
header-style: text
tags:
  - paper
  - 符号执行
  - 程序分析
---

##### Abstract & Introduction

基于缓存的侧信道正在成为一个重要的攻击载体，通过它秘密信息可以泄露给恶意方。然而，以前在基于缓存的侧信道检测方面的工作存在代码覆盖问题，或者没有提供诊断信息，而这些诊断信息对于将缓解技术应用到脆弱的软件是至关重要的。我们提出CaSym，一种缓存感知符号执行来识别和报告有关侧信道在输入程序中出现的精确信息。

与现有的工作相比，CaSym提供了几个独特的功能:(1) CaSym能够验证各种攻击模型和缓存模型,(2)与许多用于查找bug的符号执行系统不同，CaSym以一种合理的方式验证所有程序执行路径， (3)CaSym使用了两种新的抽象缓存模型，在分析可扩展性和精度之间提供了良好的平衡,和(4)CaSym提供了足够的信息，包括在哪里和如何减轻确定的侧信道通过技术包括预加载和插桩。对一组密码和数据库基准测试的评估表明，CaSym在识别和缓解侧信道方面是有效的，而且效率合理。



为了对抗基于缓存的侧信道，流行的密码实现(例如OpenSSL和Libgcrypt中的RSA和AES)的开发人员一直在手动识别侧信道，并为他们的软件打上相应的补丁。然而，手动过程经常会遗漏重要的侧信道，最近在加密实现[11]中发现的新的侧信道就是证明。此外，加密开发人员编写的高度专门的补丁对于非专业人员修复其他加密实现和其他安全敏感应用程序中的边通道几乎没有帮助。

首先，虽然一些基于符号执行的工作(例如，[11])自然地提供了一些反例，这些反例代表了显示出已识别的侧信道的程序执行，但它们只探索了一条或多条动态执行路径，并受到代码覆盖问题的困扰。也就是说，它们无法检测未执行代码中的侧信道，而且由于分支以机密数据为条件，它们也无法检测边通道。一些系统[12]、[13]使用抽象解释，它涵盖了所有的程序路径。但是它们并没有告诉开发者什么是侧信道以及为什么它们是侧信道。更重要的是，这些缺失的信息可以用来构建修复已识别的侧信道的缓解措施。

其次，适当的缓存模型对于基于语言的分析很重要。为了检测基于缓存的侧信道，一种方法是通过依赖于体系结构的缓存模型(例如[12])直接检查缓存中是否存在数据。但这些系统提供的安全保证变得依赖于体系结构，而对具体缓存模型的推理通常代价高昂。

在本文中，我们提出了一个新的框架，称为CaSym，用于检测和减轻基于缓存的侧信道。CaSym通过以下组件解决了上述限制。

1.cache-aware符号执行, CaSym接受编译器IR(具体来说，LLVM IR)中的一个程序作为输入，并执行符号执行来跟踪程序和缓存状态。CaSym的符号执行所产生的符号状态被用来构造一个公式，供SMT solver使用。该公式的一个令人满意的解决方案会产生公共值以及两个敏感值，这些值会显示基于缓存的边通道的存在:这些值会触发两次程序执行，从而导致不同的缓存状态。该公式的一个令人满意的解决方案会产生公共值以及两个敏感值，这些值会显示基于缓存的侧信道的存在:这些值会触发两次程序执行，从而导致不同的缓存状态。

##### Overview

图2描述了CaSym的系统流程。它获取输入程序的源代码，并使用LLVM的前端Clang将程序转换为LLVM IR代码。CaSym然后对IR代码执行缓存分析，以建立一个缓存公式(验证条件)，表示程序如何操作缓存状态。将该公式输入到SMT求解器中。该公式的一个满意答案意味着有一个侧信道。在这种情况下，CaSym使用来自求解器的解决方案来定位错误并报告它;然后可以使用这些信息进行缓解。不能满足的高速缓存公式是指在输入程序中不存在基于高速缓存的侧信道。

![image-20201102184759875](/Users/veronica/Library/Application Support/typora-user-images/image-20201102184759875.png)